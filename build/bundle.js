!function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){"use strict";function r(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}function o(e){return e&&e.__esModule?e:{default:e}}function a(e){var n,t,r,o,a,u=f(Ee+fe),s=B.SPRITES.PLAYER_STRAIGHT.w*B.SPRITES.SCALE,d=he/Le,E=2*e*d,L=Ee;if(i(e,u,s),Ee=x.increase(Ee,e*he,oe),Te?se-=E:ge&&(se+=E),se-=E*d*u.curve*b,he=ve?x.accelerate(he,pe,e):Ae?x.accelerate(he,Ie,e):x.accelerate(he,Re,e),se<-1||se>1)for(he>Me&&(he=x.accelerate(he,ye,e)),n=0;n<u.sprites.length;n++)if(o=u.sprites[n],a=o.source.w*B.SPRITES.SCALE,x.overlap(se,s,o.offset+a/2*(o.offset>0?1:-1),a)){he=Le/5,Ee=x.increase(u.p1.world.z,-fe,oe);break}for(n=0;n<u.cars.length;n++)if(t=u.cars[n],r=t.sprite.w*B.SPRITES.SCALE,he>t.speed&&x.overlap(se,s,t.offset,r,.8)){he=t.speed*(t.speed/he),Ee=x.increase(t.z,-fe,oe);break}se=x.limit(se,-3,3),he=x.limit(he,0,Le),W=x.increase(W,Y*u.curve*(Ee-L)/te,1),V=x.increase(V,K*u.curve*(Ee-L)/te,1),z=x.increase(z,F*u.curve*(Ee-L)/te,1),Ee>fe&&(we&&L<fe||(we+=e)),l("speed",5*Math.round(he/500)),l("current_lap_time",c(we))}function i(e,n,t){var r,o,a,i;for(r=0;r<q.length;r++)o=q[r],a=f(o.z),o.offset=o.offset+u(o,a,n,t),o.z=x.increase(o.z,e*o.speed,oe),o.percent=x.percentRemaining(o.z,te),i=f(o.z),a!=i&&(index=a.cars.indexOf(o),a.cars.splice(index,1),i.cars.push(o))}function u(e,n,t,r){var o,a,i,u,l,c,s=20,f=e.sprite.w*B.SPRITES.SCALE;if(n.index-t.index>ce)return 0;for(o=1;o<s;o++){if(u=j[(n.index+o)%j.length],u===t&&e.speed>he&&x.overlap(se,r,e.offset,f,1.2))return i=se>.5?-1:se<-.5?1:e.offset>se?1:-1,1*i/o*(e.speed-he)/Le;for(a=0;a<u.cars.length;a++)if(l=u.cars[a],c=l.sprite.w*B.SPRITES.SCALE,e.speed>l.speed&&x.overlap(e.offset,f,l.offset,c,1.2))return i=l.offset>.5?-1:l.offset<-.5?1:e.offset>l.offset?1:-1,1*i/o*(e.speed-l.speed)/Le}return e.offset<-.9?.1:e.offset>.9?-.1:0}function l(e,n){Se[e].value!==n&&(Se[e].value=n,N.default.set(Se[e].dom,n))}function c(e){var n=Math.floor(e/60),t=Math.floor(e-60*n),r=Math.floor(10*(e-Math.floor(e)));return n>0?n+"."+(t<10?"0":"")+t+"."+r:t+"."+r}function s(){var e=f(Ee),n=x.percentRemaining(Ee,te),t=f(Ee+fe),r=x.percentRemaining(Ee+fe,te),o=x.interpolate(t.p1.world.y,t.p2.world.y,r),a=_,i=0,u=-(e.curve*n);J.clearRect(0,0,k,_),H.default.background(J,Z,k,_,B.BACKGROUND.SKY,W,ee*Y*o),H.default.background(J,Z,k,_,B.BACKGROUND.HILLS,V,ee*K*o),H.default.background(J,Z,k,_,B.BACKGROUND.TREES,z,ee*F*o);var l=void 0,c=void 0,s=void 0,d=void 0,E=void 0,L=void 0,h=void 0,p=void 0;for(l=0;l<ce;l++)s=j[(e.index+l)%j.length],s.looped=s.index<e.index,s.fog=x.exponentialFog(l/ce,de),s.clip=a,x.project(s.p1,se*ne-i,o+ue,Ee-(s.looped?oe:0),le,k,_,ne),x.project(s.p2,se*ne-i-u,o+ue,Ee-(s.looped?oe:0),le,k,_,ne),i+=u,u+=s.curve,s.p1.camera.z<=le||s.p2.screen.y>=s.p1.screen.y||s.p2.screen.y>=a||(H.default.segment(J,k,ae,s.p1.screen.x,s.p1.screen.y,s.p1.screen.w,s.p2.screen.x,s.p2.screen.y,s.p2.screen.w,s.fog,s.color),a=s.p1.screen.y);for(l=ce-1;l>0;l--){for(s=j[(e.index+l)%j.length],c=0;c<s.cars.length;c++)d=s.cars[c],E=d.sprite,L=x.interpolate(s.p1.screen.scale,s.p2.screen.scale,d.percent),h=x.interpolate(s.p1.screen.x,s.p2.screen.x,d.percent)+L*d.offset*ne*k/2,p=x.interpolate(s.p1.screen.y,s.p2.screen.y,d.percent),H.default.sprite(J,k,_,ee,ne,$,d.sprite,L,h,p,-.5,-1,s.clip);for(c=0;c<s.sprites.length;c++)E=s.sprites[c],L=s.p1.screen.scale,h=s.p1.screen.x+L*E.offset*ne*k/2,p=s.p1.screen.y,H.default.sprite(J,k,_,ee,ne,$,E.source,L,h,p,E.offset<0?-1:0,-1,s.clip);s==t&&H.default.player(J,k,_,ee,ne,$,he/Le,le/fe,k/2,_/2-le/fe*x.interpolate(t.p1.camera.y,t.p2.camera.y,r)*_/2,he*(Te?-1:ge?1:0),t.p2.world.y-t.p1.world.y)}}function f(e){return j[Math.floor(e/te)%j.length]}function d(){return 0==j.length?0:j[j.length-1].p2.world.y}function E(e,n){var t=j.length;j.push({index:t,p1:{world:{y:d(),z:t*te},camera:{},screen:{}},p2:{world:{y:n,z:(t+1)*te},camera:{},screen:{}},curve:e,sprites:[],cars:[],color:Math.floor(t/re)%2?B.COLORS.DARK:B.COLORS.LIGHT})}function L(e,n,t,r,o){var a,i=d(),u=i+x.toInt(o,0)*te,l=e+n+t;for(a=0;a<e;a++)E(x.easeIn(0,r,a/e),x.easeInOut(i,u,a/l));for(a=0;a<n;a++)E(r,x.easeInOut(i,u,(e+a)/l));for(a=0;a<t;a++)E(x.easeInOut(r,0,a/t),x.easeInOut(i,u,(e+n+a)/l))}function h(e){e=e||He.LENGTH.MEDIUM,L(e,e,e,0,0)}function p(e,n){e=e||He.LENGTH.MEDIUM,n=n||He.HILL.MEDIUM,L(e,e,e,0,n)}function I(e,n,t){e=e||He.LENGTH.MEDIUM,n=n||He.CURVE.MEDIUM,t=t||He.HILL.NONE,L(e,e,e,n,t)}function R(e,n){e=e||He.LENGTH.SHORT,n=n||He.HILL.LOW,L(e,e,e,0,n/2),L(e,e,e,0,-n),L(e,e,e,He.CURVE.EASY,n),L(e,e,e,0,0),L(e,e,e,-He.CURVE.EASY,n/2),L(e,e,e,0,0)}function y(){L(He.LENGTH.MEDIUM,He.LENGTH.MEDIUM,He.LENGTH.MEDIUM,-He.CURVE.EASY,He.HILL.NONE),L(He.LENGTH.MEDIUM,He.LENGTH.MEDIUM,He.LENGTH.MEDIUM,He.CURVE.MEDIUM,He.HILL.MEDIUM),L(He.LENGTH.MEDIUM,He.LENGTH.MEDIUM,He.LENGTH.MEDIUM,He.CURVE.EASY,-He.HILL.LOW),L(He.LENGTH.MEDIUM,He.LENGTH.MEDIUM,He.LENGTH.MEDIUM,-He.CURVE.EASY,He.HILL.MEDIUM),L(He.LENGTH.MEDIUM,He.LENGTH.MEDIUM,He.LENGTH.MEDIUM,-He.CURVE.MEDIUM,-He.HILL.MEDIUM)}function M(){L(10,10,10,0,5),L(10,10,10,0,-2),L(10,10,10,0,-5),L(10,10,10,0,8),L(10,10,10,0,5),L(10,10,10,0,-7),L(10,10,10,0,5),L(10,10,10,0,-2)}function m(e){e=e||200,L(e,e,e,-He.CURVE.EASY,-d()/te)}function w(){j=[],h(He.LENGTH.SHORT),R(),y(),I(He.LENGTH.MEDIUM,He.CURVE.MEDIUM,He.HILL.LOW),M(),R(),I(2*He.LENGTH.LONG,He.CURVE.MEDIUM,He.HILL.MEDIUM),h(),p(He.LENGTH.MEDIUM,He.HILL.HIGH),y(),I(He.LENGTH.LONG,-He.CURVE.MEDIUM,He.HILL.NONE),p(He.LENGTH.LONG,He.HILL.HIGH),I(He.LENGTH.LONG,He.CURVE.MEDIUM,-He.HILL.LOW),M(),p(He.LENGTH.LONG,-He.HILL.MEDIUM),h(),y(),m(),T(),g(),j[f(fe).index+2].color=B.COLORS.START,j[f(fe).index+3].color=B.COLORS.START;for(var e=0;e<re;e++)j[j.length-1-e].color=B.COLORS.FINISH;oe=j.length*te}function T(){}function g(){q=[];for(var e,n,t,r,o,a,i,e=0;e<me;e++)r=Math.random()*x.randomChoice([-.8,.8]),o=Math.floor(Math.random()*j.length)*te,a=x.randomChoice(B.SPRITES.CARS),i=Le/4+Math.random()*Le/(a==B.SPRITES.SEMI?4:2),n={offset:r,z:o,sprite:a,speed:i},t=f(n.z),t.cars.push(n),q.push(n)}function v(e){e=e||{},X.width=k=x.toInt(e.width,k),X.height=_=x.toInt(e.height,_),ae=x.toInt(e.lanes,ae),ne=x.toInt(e.roadWidth,ne),ue=x.toInt(e.cameraHeight,ue),ce=x.toInt(e.drawDistance,ce),de=x.toInt(e.fogDensity,de),ie=x.toInt(e.fieldOfView,ie),te=x.toInt(e.segmentLength,te),re=x.toInt(e.rumbleLength,re),le=1/Math.tan(ie/2*Math.PI/180),fe=ue*le,ee=_/480,A(),(0==j.length||e.segmentLength||e.rumbleLength)&&w()}function A(){N.default.get("lanes").selectedIndex=ae-1,N.default.get("currentRoadWidth").innerHTML=N.default.get("roadWidth").value=ne,N.default.get("currentCameraHeight").innerHTML=N.default.get("cameraHeight").value=ue,N.default.get("currentDrawDistance").innerHTML=N.default.get("drawDistance").value=ce,N.default.get("currentFieldOfView").innerHTML=N.default.get("fieldOfView").value=ie,N.default.get("currentFogDensity").innerHTML=N.default.get("fogDensity").value=de}var S=t(5),H=o(S),D=t(4),O=o(D),U=t(1),x=r(U),C=t(2),N=o(C),B=t(3);window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,n){window.setTimeout(e,1e3/60)});var P=60,G=1/P,k=1024,_=768,b=.3,Y=.001,K=.002,F=.003,W=0,V=0,z=0,j=[],q=[],X=N.default.get("canvas"),J=X.getContext("2d"),Q="intro",Z=null,$=null,ee=null,ne=2e3,te=200,re=3,oe=null,ae=3,ie=100,ue=1e3,le=null,ce=150,se=0,fe=null,de=4,Ee=0,Le=te/G*1.5,he=0,pe=Le/5,Ie=-Le,Re=-Le/5,ye=-Le/2,Me=Le/4,me=200,we=0,Te=!1,ge=!1,ve=!1,Ae=!1,Se={speed:{value:null,dom:N.default.get("speed_value")},current_lap_time:{value:null,dom:N.default.get("current_lap_time_value")}},He={LENGTH:{NONE:0,SHORT:25,MEDIUM:50,LONG:100},HILL:{NONE:0,LOW:20,MEDIUM:40,HIGH:60},CURVE:{NONE:0,EASY:2,MEDIUM:4,HARD:6}},De=new O.default;De.run({canvas:X,render:s,update:a,step:G,images:["intro","background","sprites"],keys:[{keys:[B.KEY.LEFT,B.KEY.A],mode:"down",action:function(){Te=!0}},{keys:[B.KEY.RIGHT,B.KEY.D],mode:"down",action:function(){ge=!0}},{keys:[B.KEY.UP,B.KEY.W],mode:"down",action:function(){ve=!0}},{keys:[B.KEY.DOWN,B.KEY.S],mode:"down",action:function(){Ae=!0}},{keys:[B.KEY.LEFT,B.KEY.A],mode:"up",action:function(){Te=!1}},{keys:[B.KEY.RIGHT,B.KEY.D],mode:"up",action:function(){ge=!1}},{keys:[B.KEY.UP,B.KEY.W],mode:"up",action:function(){ve=!1}},{keys:[B.KEY.DOWN,B.KEY.S],mode:"up",action:function(){Ae=!1}}],ready:function(e){"intro"===Q||"select_player"===Q?Z=e[0]:(Z=e[0],$=e[1]),console.log("BACK: ",Z),v()}})},function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(){return(new Date).getTime()},r=function e(n,t){if(null!==n){var r=parseInt(n,10);if(!isNaN(r))return r}return e(t,0)},o=function e(n,t){if(null!==n){var r=parseFloat(n);if(!isNaN(r))return r}return e(t,0)},a=function(e,n,t){return Math.max(n,Math.min(e,t))},i=function(e,n){return Math.round(s(e,n,Math.random()))},u=function(e){return e[i(0,e.length-1)]},l=function(e,n){return e%n/n},c=function(e,n,t){return e+n*t},s=function(e,n,t){return e+(n-e)*t},f=function(e,n,t){return e+(n-e)*Math.pow(t,2)},d=function(e,n,t){return e+(n-e)*(1-Math.pow(1-t,2))},E=function(e,n,t){return e+(n-e)*(-Math.cos(t*Math.PI)/2+.5)},L=function(e,n){return 1/Math.pow(Math.E,e*e*n)},h=function(e,n,t){for(var r=e+n;r>=t;)r-=t;for(;r<0;)r+=t;return r},p=function(e,n,t,r,o,a,i,u){e.camera.x=(e.world.x||0)-n,e.camera.y=(e.world.y||0)-t,e.camera.z=(e.world.z||0)-r,e.screen.scale=o/e.camera.z,e.screen.x=Math.round(a/2+e.screen.scale*e.camera.x*a/2),e.screen.y=Math.round(i/2-e.screen.scale*e.camera.y*i/2),e.screen.w=Math.round(e.screen.scale*u*a/2)},I=function(e,n,t,r,o){var a=(o||1)/2,i=e-n*a,u=e+n*a,l=t-r*a,c=t+r*a;return!(u<l||i>c)};n.timestamp=t,n.toInt=r,n.toFloat=o,n.limit=a,n.randomInt=i,n.randomChoice=u,n.percentRemaining=l,n.accelerate=c,n.interpolate=s,n.easeIn=f,n.easeOut=d,n.easeInOut=E,n.exponentialFog=L,n.increase=h,n.project=p,n.overlap=I},function(e,n){"use strict";function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=function(){function e(){t(this,e),this.storage=window.localStorage||{}}return r(e,[{key:"get",value:function(e){return e instanceof HTMLElement||e===document?e:document.getElementById(e)}},{key:"set",value:function(e,n){this.get(e).innerHTML=n}},{key:"on",value:function(e,n,t,r){this.get(e).addEventListener(n,t,r)}},{key:"un",value:function(e,n,t,r){this.get(e).removeEventListener(n,t,r)}},{key:"show",value:function(e,n){this.get(e).style.display=n||"block"}},{key:"blur",value:function(e){e.target.blur()}},{key:"addClassName",value:function(e,n){this.toggleClassName(e,n,!0)}},{key:"removeClassName",value:function(e,n){this.toggleClassName(e,n,!1)}},{key:"toggleClassName",value:function(e,n,t){e=this.get(e);var r=e.className.split(" "),o=r.indexOf(n);t="undefined"==typeof t?o<0:t,t&&o<0?r.push(n):!t&&o>=0&&r.splice(o,1),e.className=r.join(" ")}}]),e}(),a=new o;n.default=a},function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t={LEFT:37,UP:38,RIGHT:39,DOWN:40,A:65,D:68,S:83,W:87},r={SKY:"#72D7EE",TREE:"#005108",FOG:"#005108",LIGHT:{road:"#6B6B6B",grass:"#10AA10",rumble:"#555555",lane:"#CCCCCC"},DARK:{road:"#696969",grass:"#009A00",rumble:"#BBBBBB"},START:{road:"white",grass:"white",rumble:"white"},FINISH:{road:"black",grass:"black",rumble:"black"}},o={HILLS:{x:5,y:5,w:1280,h:480},SKY:{x:5,y:495,w:1280,h:480},TREES:{x:5,y:985,w:1280,h:480}},a={PALM_TREE:{x:5,y:5,w:215,h:540},BILLBOARD08:{x:230,y:5,w:385,h:265},TREE1:{x:625,y:5,w:360,h:360},DEAD_TREE1:{x:5,y:555,w:135,h:332},BILLBOARD09:{x:150,y:555,w:328,h:282},BOULDER3:{x:230,y:280,w:320,h:220},COLUMN:{x:995,y:5,w:200,h:315},BILLBOARD01:{x:625,y:375,w:300,h:170},BILLBOARD06:{x:488,y:555,w:298,h:190},BILLBOARD05:{x:5,y:897,w:298,h:190},BILLBOARD07:{x:313,y:897,w:298,h:190},BOULDER2:{x:621,y:897,w:298,h:140},TREE2:{x:1205,y:5,w:282,h:295},BILLBOARD04:{x:1205,y:310,w:268,h:170},DEAD_TREE2:{x:1205,y:490,w:150,h:260},BOULDER1:{x:1205,y:760,w:168,h:248},BUSH1:{x:5,y:1097,w:240,h:155},CACTUS:{x:929,y:897,w:235,h:118},BUSH2:{x:255,y:1097,w:232,h:152},BILLBOARD03:{x:5,y:1262,w:230,h:220},BILLBOARD02:{x:245,y:1262,w:215,h:220},STUMP:{x:995,y:330,w:195,h:140},SEMI:{x:1365,y:490,w:122,h:144},TRUCK:{x:1365,y:644,w:100,h:78},CAR03:{x:1383,y:760,w:88,h:55},CAR02:{x:1383,y:825,w:80,h:59},CAR04:{x:1383,y:894,w:80,h:57},CAR01:{x:1205,y:1018,w:80,h:56},PLAYER_UPHILL_LEFT:{x:1383,y:961,w:80,h:45},PLAYER_UPHILL_STRAIGHT:{x:1295,y:1018,w:80,h:45},PLAYER_UPHILL_RIGHT:{x:1385,y:1018,w:80,h:45},PLAYER_LEFT:{x:992,y:480,w:90,h:67},PLAYER_STRAIGHT:{x:1086,y:470,w:86,h:77},PLAYER_RIGHT:{x:992,y:548,w:90,h:67}};a.SCALE=.3*(1/a.PLAYER_STRAIGHT.w),a.BILLBOARDS=[a.BILLBOARD01,a.BILLBOARD02,a.BILLBOARD03,a.BILLBOARD04,a.BILLBOARD05,a.BILLBOARD06,a.BILLBOARD07,a.BILLBOARD08,a.BILLBOARD09],a.PLANTS=[a.TREE1,a.TREE2,a.DEAD_TREE1,a.DEAD_TREE2,a.PALM_TREE,a.BUSH1,a.BUSH2,a.CACTUS,a.STUMP,a.BOULDER1,a.BOULDER2,a.BOULDER3],a.CARS=[a.CAR01,a.CAR02,a.CAR03,a.CAR04,a.SEMI,a.TRUCK],n.KEY=t,n.COLORS=r,n.BACKGROUND=o,n.SPRITES=a},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),i=t(2),u=r(i),l=t(1),c=function(){function e(){o(this,e)}return a(e,[{key:"run",value:function(e){var n=this;this.loadImages(e.images,function(t){function r(){for(c=(0,l.timestamp)(),f=Math.min(1,(c-s)/1e3),d+=f;d>u;)d-=u,a(u);i(),s=c,requestAnimationFrame(r,o)}e.ready(t),n.setKeyListener(e.keys);var o=e.canvas,a=e.update,i=e.render,u=e.step,c=null,s=(0,l.timestamp)(),f=0,d=0;r()})}},{key:"loadImages",value:function(e,n){var t=function(e){return new Promise(function(n,t){var r=new Image;r.onload=n(r),r.onerror=n(),r.src=e})};Promise.all(e.map(function(e){var n="../static/images/"+e+".png";return t(n)})).then(function(e){n(e)}).catch(function(e){n(e)})}},{key:"setKeyListener",value:function(e){var n=function(n,t){var r,o;for(r=0;r<e.length;r++)o=e[r],o.mode=o.mode||"up",(o.key==n||o.keys&&o.keys.indexOf(n)>=0)&&o.mode==t&&o.action.call()};u.default.on(document,"keydown",function(e){n(e.keyCode,"down")}),u.default.on(document,"keyup",function(e){n(e.keyCode,"up")})}}]),e}();n.default=c},function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),a=t(1),i=t(3),u=function(){function e(){r(this,e)}return o(e,[{key:"polygon",value:function(e,n,t,r,o,a,i,u,l,c){e.fillStyle=c,e.beginPath(),e.moveTo(n,t),e.lineTo(r,o),e.lineTo(a,i),e.lineTo(u,l),e.closePath(),e.fill()}},{key:"segment",value:function(e,n,t,r,o,a,i,u,l,c,s){var f,d,E,L,h,p=this.rumbleWidth(a,t),I=this.rumbleWidth(l,t),R=this.laneMarkerWidth(a,t),y=this.laneMarkerWidth(l,t);if(e.fillStyle=s.grass,e.fillRect(0,u,n,o-u),this.polygon(e,r-a-p,o,r-a,o,i-l,u,i-l-I,u,s.rumble),this.polygon(e,r+a+p,o,r+a,o,i+l,u,i+l+I,u,s.rumble),this.polygon(e,r-a,o,r+a,o,i+l,u,i-l,u,s.road),s.lane)for(f=2*a/t,d=2*l/t,E=r-a+f,L=i-l+d,h=1;h<t;E+=f,L+=d,h++)this.polygon(e,E-R/2,o,E+R/2,o,L+y/2,u,L-y/2,u,s.lane);this.fog(e,0,o,n,u-o,c)}},{key:"background",value:function(e,n,t,r,o,a,i){a=a||0,i=i||0;var u=o.w/2,l=o.h,c=o.x+Math.floor(o.w*a),s=o.y,f=Math.min(u,o.x+o.w-c),d=l,E=0,L=i,h=Math.floor(t*(f/u)),p=r;console.log("CTX: ",e,n),e.drawImage(n,c,s,f,d,E,L,h,p),f<u&&e.drawImage(n,o.x,s,u-f,d,h-1,L,t-h,p)}},{key:"sprite",value:function(e,n,t,r,o,a,u,l,c,s,f,d,E){var L=u.w*l*n/2*(i.SPRITES.SCALE*o),h=u.h*l*n/2*(i.SPRITES.SCALE*o);c+=L*(f||0),s+=h*(d||0);var p=E?Math.max(0,s+h-E):0;p<h&&e.drawImage(a,u.x,u.y,u.w,u.h-u.h*p/h,c,s,L,h-p)}},{key:"player",value:function(e,n,t,r,o,u,l,c,s,f,d,E){var L,h=1.5*Math.random()*l*r*(0,a.randomChoice)([-1,1]);L=d<0?E>0?i.SPRITES.PLAYER_UPHILL_LEFT:i.SPRITES.PLAYER_LEFT:d>0?E>0?i.SPRITES.PLAYER_UPHILL_RIGHT:i.SPRITES.PLAYER_RIGHT:E>0?i.SPRITES.PLAYER_UPHILL_STRAIGHT:i.SPRITES.PLAYER_STRAIGHT,this.sprite(e,n,t,r,o,u,L,c,s,f+h,-.5,-1)}},{key:"fog",value:function(e,n,t,r,o,a){a<1&&(e.globalAlpha=1-a,e.fillStyle=i.COLORS.FOG,e.fillRect(n,t,r,o),e.globalAlpha=1)}},{key:"rumbleWidth",value:function(e,n){return e/Math.max(6,2*n)}},{key:"laneMarkerWidth",value:function(e,n){return e/Math.max(32,8*n)}}]),e}(),l=new u;n.default=l}]);
//# sourceMappingURL=bundle.js.map